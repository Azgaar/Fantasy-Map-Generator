(function(){"use strict";function g(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var p={exports:{}},d=p.exports,x;function y(){return x||(x=1,(function(u,h){(function(i,s){u.exports=s()})(d,function(){return i.importState=function(t){var n=new i;return n.importState(t),n},i;function i(){return(function(t){var n=0,e=0,r=0,o=1;t.length==0&&(t=[+new Date]);var c=s();n=c(" "),e=c(" "),r=c(" ");for(var l=0;l<t.length;l++)n-=c(t[l]),n<0&&(n+=1),e-=c(t[l]),e<0&&(e+=1),r-=c(t[l]),r<0&&(r+=1);c=null;var a=function(){var f=2091639*n+o*23283064365386963e-26;return n=e,e=r,r=f-(o=f|0)};return a.next=a,a.uint32=function(){return a()*4294967296},a.fract53=function(){return a()+(a()*2097152|0)*11102230246251565e-32},a.version="Alea 0.9",a.args=t,a.exportState=function(){return[n,e,r,o]},a.importState=function(f){n=+f[0]||0,e=+f[1]||0,r=+f[2]||0,o=+f[3]||0},a})(Array.prototype.slice.call(arguments))}function s(){var t=4022871197,n=function(e){e=e.toString();for(var r=0;r<e.length;r++){t+=e.charCodeAt(r);var o=.02519603282416938*t;t=o>>>0,o-=t,o*=t,t=o>>>0,o-=t,t+=o*4294967296}return(t>>>0)*23283064365386963e-26};return n.version="Mash 0.9",n}})})(p)),p.exports}var z=y(),M=g(z);class w{prng;map;size;constructor(h,i=256){this.prng=M(h),this.size=i,this.map=new Float32Array(i*i);for(let s=0;s<this.map.length;s++)this.map[s]=this.prng()}get(h,i){const s=Math.floor(h)&this.size-1,t=Math.floor(i)&this.size-1,n=h-Math.floor(h),e=i-Math.floor(i),r=n*n*(3-2*n),o=e*e*(3-2*e),c=this.map[s+t*this.size],l=this.map[(s+1&this.size-1)+t*this.size],a=this.map[s+(t+1&this.size-1)*this.size],f=this.map[(s+1&this.size-1)+(t+1&this.size-1)*this.size],m=c+r*(l-c),v=a+r*(f-a);return m+o*(v-m)}fbm(h,i,s){let t=0,n=.5,e=1,r=0;for(let o=0;o<s;o++)t+=this.get(h*e,i*e)*n,r+=n,n*=.5,e*=2;return t/r}}self.onmessage=u=>{const{type:h}=u.data;if(h==="init"){const{buffer:i,width:s,height:t,seed:n}=u.data,e=new Uint8ClampedArray(i),r=new w(n);console.log(`Worker: Generating ${s}x${t} map with seed ${n}`);for(let o=0;o<t;o++)for(let c=0;c<s;c++){const l=(o*s+c)*4,a=c/s*4,f=o/t*4,m=r.fbm(a,f,6),v=r.fbm(a+17.1,f+31.4,6);e[l]=Math.floor(m*255),e[l+1]=Math.floor(v*255),e[l+2]=0,e[l+3]=255}self.postMessage({type:"complete"})}}})();
